length = (-> receiver.prefixLength):pfl <anything{pfl}>:slen -> receiver.getStringLength(slen)

item = length:l (?(receiver.checkStringLength(l)) <anything{l}>:data
            | -> receiver.lengthLimitExceeded(l)
            )


initial = (length:l ?(l == 0) -> receiver.proto_boxReceived()
            | !(receiver.MAX_LENGTH = receiver.MAX_KEY_LENGTH) item:key
              !(receiver.MAX_LENGTH = receiver.MAX_VALUE_LENGTH) item:value
              -> receiver.proto_keyvalue(key, value)
)